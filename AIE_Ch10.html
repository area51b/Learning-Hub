<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Engineering: Chapter 10 Interactive Summary - Architecture & User Feedback</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Visualization & Content Choices:
        - Navigation: Sidebar with 11 links (JS content switching). Goal: Easy access.
        - Progressive Architecture (Slides 2-7): A unified interactive HTML/CSS vertical step-diagram. Each step (layer) is clickable to display its specific content (from the corresponding slide) in a detail area. Goal: Visualize evolution and allow focused exploration of each layer.
        - User Feedback Intro (Slide 8): Standard text.
        - Feedback Types (Slide 9): Side-by-side styled cards for Direct vs. Implicit feedback. Goal: Clear comparison.
        - Designing Feedback Systems (Slide 10): Accordion for strategies. Goal: Digestible list of points.
        - Conclusion (Slide 11): Chart.js Doughnut chart for 'Key Pillars' (Progressive Architecture, User Feedback Integration). Goal: Visual summary of core themes.
        - All textual content from source.
        - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .nav-link {
            display: block;
            padding: 0.75rem 1rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            cursor: pointer;
            font-size: 0.875rem; /* Slightly smaller for more items */
        }
        .nav-link:hover {
            background-color: #f0f9ff; /* sky-50 */
            color: #0369a1; /* sky-700 */
        }
        .nav-link.active {
            background-color: #0ea5e9; /* sky-500 */
            color: white;
            font-weight: 600;
        }
        .accordion-header {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .accordion-header:hover {
            background-color: #f8fafc; /* slate-50 */
        }
        .accordion-content {
            display: none;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
        }
        .accordion-content.open {
            display: block;
            max-height: 1000px; 
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px; 
            margin-left: auto;
            margin-right: auto;
            height: 350px; 
            max-height: 400px;
        }
        @media (min-width: 768px) { /* md breakpoint */
            .chart-container {
                height: 400px;
            }
        }
        .info-card {
            background-color: #f0fdfa; /* teal-50 */
            border: 1px solid #99f6e4; /* teal-200 */
            padding: 1rem;
            border-radius: 0.5rem;
            transition: box-shadow 0.2s, transform 0.2s;
        }
        .info-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.07);
        }
        .arch-layer {
            background-color: #f0f9ff; /* sky-50 */
            border: 1px solid #bae6fd; /* sky-200 */
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }
        .arch-layer:hover, .arch-layer.active-layer {
            background-color: #e0f2fe; /* sky-100 */
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-color: #7dd3fc; /* sky-300 */
        }
        .arch-layer-arrow {
            text-align: center;
            font-size: 1.5rem; /* 24px */
            color: #38bdf8; /* sky-400 */
            line-height: 1;
        }
        .feedback-card {
            background-color: #f0f9ff; /* sky-50 */
            border: 1px solid #bae6fd; /* sky-200 */
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

    <div class="flex flex-col md:flex-row min-h-screen">
        <nav class="w-full md:w-80 bg-white p-6 shadow-lg flex-shrink-0"> <h1 class="text-2xl font-bold text-sky-700 mb-6 border-b pb-3">AI Engineering Ch.10</h1>
            <ul class="space-y-1">
                <li><a class="nav-link active" data-target="slide1-ch10">1. Intro: Arch. & Feedback</a></li>
                <li><a class="nav-link" data-target="slide2-ch10">2. Progressive Architecture</a></li>
                <li><a class="nav-link" data-target="slide3-ch10">3. Enhancement Layer (RAG)</a></li>
                <li><a class="nav-link" data-target="slide4-ch10">4. Protection Layer (Guardrails)</a></li>
                <li><a class="nav-link" data-target="slide5-ch10">5. Routing Layer (Gateway)</a></li>
                <li><a class="nav-link" data-target="slide6-ch10">6. Performance Layer (Caching)</a></li>
                <li><a class="nav-link" data-target="slide7-ch10">7. Agent Layer</a></li>
                <li><a class="nav-link" data-target="slide8-ch10">8. User Feedback: Crucial Source</a></li>
                <li><a class="nav-link" data-target="slide9-ch10">9. Types of AI Feedback</a></li>
                <li><a class="nav-link" data-target="slide10-ch10">10. Designing Feedback Systems</a></li>
                <li><a class="nav-link" data-target="slide11-ch10">11. Conclusion: Holistic Design</a></li>
            </ul>
        </nav>

        <main class="flex-1 p-6 md:p-10 overflow-y-auto">
            
            <section id="slide1-ch10" class="content-section active">
                <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-semibold text-sky-700 mb-6">Introduction to AI Engineering Architecture & User Feedback</h2>
                    <p class="mb-6 text-slate-600">This section introduces Chapter 10, which synthesizes various AI engineering techniques into a cohesive strategy for building successful, production-ready AI products. It emphasizes a progressive architectural framework and the critical role of user feedback in the AI development lifecycle.</p>
                    <div class="space-y-4 text-slate-700">
                        <p><strong class="text-sky-600">Objective:</strong> This chapter brings together various AI engineering techniques to build successful, production-ready AI products. It moves from individual techniques to their integration into a coherent system.</p>
                        <p><strong class="text-sky-600">Architectural Focus:</strong> It presents a progressive framework for AI application architecture, starting simple and gradually adding layers of complexity and capability to address common challenges in production AI systems.</p>
                        <p><strong class="text-sky-600">User Feedback's Role:</strong> User feedback is highlighted as an invaluable and crucial data source for improving AI models (e.g., for finetuning, preference alignment) and guiding overall product development, especially in conversational AI applications where interaction quality is paramount.</p>
                        <p><strong class="text-sky-600">Challenge:</strong> Selecting the right combination of techniques and tools from a wide array of options can be overwhelming. This chapter aims to provide a structured approach to simplify this process and guide decision-making.</p>
                    </div>
                </div>
            </section>

            <section id="slide2-ch10" class="content-section">
                <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-semibold text-sky-700 mb-6">Progressive Architecture Patterns</h2>
                    <p class="mb-6 text-slate-600">AI engineering architectures typically evolve in stages, adding layers of complexity and capability as needed. This section outlines this progressive framework, from basic model integration to sophisticated agent-based systems. Click on each layer to learn more about its purpose and components.</p>
                    
                    <div class="flex flex-col md:flex-row gap-6">
                        <div class="md:w-1/3 space-y-2" id="archLayersNav">
                            </div>
                        <div class="md:w-2/3 p-4 bg-slate-50 border border-slate-200 rounded-lg min-h-[300px]" id="archLayerDetail">
                            <p class="text-slate-500 text-center pt-10">Select an architectural layer from the left to see its details.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <div id="arch-layer-base-content" class="hidden">
                <h3 class="text-xl font-semibold text-sky-600 mb-3">Base Layer: Direct Model Integration</h3>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Description:</strong> The simplest architectural pattern involves direct queries to model APIs (e.g., calling an LLM API directly from the application backend).</p>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Characteristics:</strong> Straightforward to implement, quick for prototyping.</p>
                <p class="text-sm text-slate-700"><strong class="text-rose-600">Limitation:</strong> Lacks the sophistication and robustness needed for most production applications. It typically offers no external context, no safety filters, no cost management, and no advanced interaction capabilities.</p>
            </div>
            <div id="arch-layer-enhancement-content" class="hidden">
                <h3 class="text-xl font-semibold text-sky-600 mb-3">Enhancement Layer: Context Augmentation (RAG)</h3>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Purpose:</strong> To enrich model responses by providing external, custom, or up-to-date data, thereby making the AI more knowledgeable and its outputs more accurate.</p>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Mechanism:</strong> Implements Retrieval-Augmented Generation (RAG). User queries are first used to retrieve relevant information from external data sources (e.g., vector databases, document stores, APIs). This retrieved context is then added to the original query and sent to the LLM.</p>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Benefit:</strong> Significantly improves response quality, relevance, and factual grounding. Reduces hallucinations by providing the model with pertinent information to base its answers on.</p>
                <p class="text-sm text-slate-700"><strong class="text-teal-600">Integration:</strong> This layer adds a retrieval component (and potentially a data ingestion pipeline for the knowledge base) before the direct model integration of the base layer.</p>
            </div>
             <div id="arch-layer-protection-content" class="hidden">
                <h3 class="text-xl font-semibold text-sky-600 mb-3">Protection Layer: Guardrails Implementation</h3>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Purpose:</strong> To ensure system safety, reliability, and compliance by filtering both inputs to the LLM and outputs from the LLM.</p>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Guardrails:</strong> These are protective mechanisms that monitor and manage the data flowing into and out of the language model.</p>
                <div class="text-sm text-slate-700 space-y-2">
                    <div><strong class="text-sky-700">Input Guardrails:</strong> Filter sensitive or malicious information *before* it reaches the LLM.
                        <ul class="list-disc list-inside ml-4 text-xs text-slate-500"><li>Examples: Stripping Personal Identifiable Information (PII), detecting and blocking prompt injection attempts, filtering harmful content from user queries, redacting API keys or other confidential data.</li></ul>
                    </div>
                    <div><strong class="text-sky-700">Output Guardrails:</strong> Monitor and manage model outputs *after* generation and before they are shown to the user.
                        <ul class="list-disc list-inside ml-4 text-xs text-slate-500"><li>Examples: Ensuring format compliance (e.g., valid JSON, specific length), checking for factual consistency (if possible), hallucination detection, filtering toxic or biased content, privacy protection (e.g., ensuring no PII is leaked in the response), brand risk monitoring.</li></ul>
                    </div>
                </div>
            </div>
            <div id="arch-layer-routing-content" class="hidden">
                <h3 class="text-xl font-semibold text-sky-600 mb-3">Routing Layer: Gateway and Model Selection</h3>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Purpose:</strong> To efficiently manage and optimize LLM interactions, especially in systems that might use multiple different models or model providers.</p>
                <div class="text-sm text-slate-700 space-y-3">
                    <div><strong class="text-sky-700">Key Component 1: AI Gateway</strong>
                        <ul class="list-disc list-inside ml-4 text-xs text-slate-500">
                            <li>A centralized access point for all LLM interactions within an organization or application.</li>
                            <li><strong>Functions:</strong> Manages costs by tracking usage across different models/departments, abstracts API keys for security, provides a unified interface for potentially various underlying LLM providers, can handle standardized logging and monitoring.</li>
                        </ul>
                    </div>
                    <div><strong class="text-sky-700">Key Component 2: Model Router (Intent Classifier)</strong>
                         <ul class="list-disc list-inside ml-4 text-xs text-slate-500">
                            <li>An intelligent component (often an ML model itself, like an intent classifier) that directs incoming user queries to the most appropriate LLM based on factors like query complexity, user intent, task requirements, or cost considerations.</li>
                            <li><strong>Benefit:</strong> Enables significant cost optimization. For example, simpler queries (like FAQs or basic summarization) can be routed to smaller, less expensive models, while more complex reasoning or creative tasks are sent to more powerful (and typically more expensive) flagship models.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div id="arch-layer-performance-content" class="hidden">
                <h3 class="text-xl font-semibold text-sky-600 mb-3">Performance Layer: Caching Strategies</h3>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Purpose:</strong> To reduce latency (response time) and operational costs by storing and reusing previous inference results, avoiding redundant computations by the LLM.</p>
                <div class="text-sm text-slate-700 space-y-3">
                    <div><strong class="text-sky-700">1. Exact Caching:</strong>
                        <ul class="list-disc list-inside ml-4 text-xs text-slate-500">
                            <li><strong>Mechanism:</strong> Stores identical (or normalized identical) queries and their exact, previously generated responses.</li>
                            <li><strong>Use Case:</strong> Particularly valuable for frequently asked questions, repeated sub-queries in multi-step operations, or high-traffic, identical requests.</li>
                            <li><strong>Considerations:</strong> Requires careful cache eviction policies (e.g., Least Recently Used - LRU, Least Frequently Used - LFU, First In, First Out - FIFO) to manage cache size. Security is also a concern to prevent data leaks between users if queries are similar but user contexts differ.</li>
                        </ul>
                    </div>
                    <div><strong class="text-sky-700">2. Semantic Caching:</strong>
                         <ul class="list-disc list-inside ml-4 text-xs text-slate-500">
                            <li><strong>Mechanism:</strong> Uses embedding-based search to identify and retrieve responses for *semantically similar* queries, not just exact string matches. If a new query is close enough in meaning to a cached query, the cached response might be used or adapted.</li>
                            <li><strong>Dependency:</strong> Relies heavily on the quality of embeddings used to represent queries and the reliability of similarity metrics to determine "closeness."</li>
                             <li><strong>Complexity:</strong> More prone to failure or providing slightly off-topic answers due to the inherent complexity of semantic similarity and potential inaccuracies in embedding comparisons. Requires careful tuning of similarity thresholds.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div id="arch-layer-agent-content" class="hidden">
                <h3 class="text-xl font-semibold text-sky-600 mb-3">Agent Layer: Advanced Functionality</h3>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Purpose:</strong> To enable more autonomous, multi-step, and complex workflows by integrating agentic capabilities into the AI system. This layer allows the AI to do more than just respond to queries; it can take actions and interact with its environment.</p>
                <p class="text-sm text-slate-700 mb-2"><strong class="text-teal-600">Functionality Added:</strong></p>
                <ul class="list-disc list-inside ml-4 text-xs text-slate-600 space-y-1">
                    <li><strong>Retry Loops for Reliability:</strong> Agents can be programmed to automatically retry failed actions or steps in a workflow, improving the overall robustness of the application.</li>
                    <li><strong>Tool Usage Capabilities:</strong> Agents can dynamically select and use external tools (e.g., calling APIs, running code interpreters, accessing databases) to gather information or perform specific sub-tasks needed to fulfill a larger goal.</li>
                    <li><strong>Action Execution:</strong> Ability to perform real-world actions beyond just generating text, such as sending emails, creating calendar events, manipulating files, or interacting with other software systems.</li>
                    <li><strong>Complex Workflow Orchestration:</strong> Agents can plan and execute multi-step processes, make decisions based on intermediate results, and manage complex sequences of operations to achieve high-level user goals.</li>
                </ul>
                <p class="text-sm text-slate-700 mt-2"><strong class="text-teal-600">Integration:</strong> This layer represents the highest level of architectural sophistication in the progressive framework, often building upon and combining all the functionalities of the previous layers (context augmentation, guardrails, routing, caching) to support its advanced operations.</p>
            </div>

            <section id="slide8-ch10" class="content-section">
                 <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-semibold text-sky-700 mb-6">User Feedback: A Crucial Data Source</h2>
                    <p class="mb-6 text-slate-600">User feedback is not just a 'nice-to-have' but a cornerstone of developing effective and continuously improving AI applications. This section emphasizes its critical role, especially in the context of conversational AI, where interactions are dynamic and nuanced.</p>
                    <div class="space-y-4 text-slate-700">
                        <p><strong class="text-sky-600">Invaluable for Product Development:</strong> User feedback has always been essential for guiding product iterations, identifying pain points, and ensuring user satisfaction in traditional software.</p>
                        <p><strong class="text-rose-600">Crucial for AI Applications:</strong> For AI applications, particularly those involving generative models and complex interactions, user feedback plays an even more critical role. It serves as a direct and rich data source for:
                            <ul class="list-disc list-inside ml-6 text-sm text-slate-500">
                                <li>Improving model performance (e.g., through finetuning on corrected examples).</li>
                                <li>Enhancing model alignment with human preferences and values.</li>
                                <li>Identifying and mitigating biases or harmful outputs.</li>
                                <li>Discovering new use cases or areas where the AI struggles.</li>
                            </ul>
                        </p>
                        <div><strong class="text-sky-600">Conversational Interface Impact:</strong>
                            <ul class="list-disc list-inside ml-6 mt-1 space-y-1 text-sm">
                                <li><strong class="text-teal-600">Easier Feedback Provision:</strong> Conversational interfaces (chatbots, voice assistants) can make it easier and more natural for users to provide feedback in real-time (e.g., "That's not right," "Can you try again but focus on X?").</li>
                                <li><strong class="text-amber-600">Harder Signal Extraction:</strong> However, extracting clear, structured, and actionable signals from unstructured conversational feedback can be more challenging for developers compared to traditional explicit feedback mechanisms like star ratings or structured forms. This requires sophisticated analysis techniques.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section id="slide9-ch10" class="content-section">
                <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-semibold text-sky-700 mb-6">Types of Conversational AI Feedback</h2>
                    <p class="mb-6 text-slate-600">Understanding the different types of feedback users provide in conversational AI systems is key to effectively leveraging this information. This section distinguishes between direct (explicit) feedback and implicit feedback signals.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="feedback-card p-6 rounded-lg shadow">
                            <h3 class="text-xl font-semibold text-sky-600 mb-3">1. Direct Feedback (Explicit Signals)</h3>
                            <p class="text-sm text-slate-700 mb-2">Clear and intentional signals provided by users about the quality or usefulness of the AI's response or interaction.</p>
                            <p class="text-xs text-slate-500 mb-1"><strong class="text-teal-600">Examples:</strong></p>
                            <ul class="list-disc list-inside ml-4 text-xs text-slate-600 space-y-1">
                                <li>Up/down votes or thumbs up/down buttons on messages.</li>
                                <li>Responses to prompts like "Was this helpful? (Yes/No)".</li>
                                <li>Star ratings for the conversation or specific turns.</li>
                                <li>Free-text comments or corrections submitted by the user.</li>
                                <li>User explicitly editing the AI's response.</li>
                            </ul>
                            <p class="text-sm text-slate-700 mt-3"><strong class="text-teal-600">Benefit:</strong> Provides clear, labeled data that is highly valuable for model improvement, finetuning, and preference alignment.</p>
                        </div>
                        <div class="feedback-card p-6 rounded-lg shadow">
                            <h3 class="text-xl font-semibold text-sky-600 mb-3">2. Implicit Feedback (Inferred Signals)</h3>
                            <p class="text-sm text-slate-700 mb-2">Signals inferred from user behavior during or after the interaction with the AI, without the user explicitly stating their satisfaction or dissatisfaction.</p>
                            <p class="text-xs text-slate-500 mb-1"><strong class="text-teal-600">Examples:</strong></p>
                            <ul class="list-disc list-inside ml-4 text-xs text-slate-600 space-y-1">
                                <li><strong>Engagement Metrics:</strong> Session duration, number of turns in a conversation, frequency of repeated queries (may indicate misunderstanding).</li>
                                <li><strong>Follow-up Actions:</strong> Did the user click a link provided by the AI? Did they rephrase their question (suggesting the first answer wasn't clear)? Did they abandon the conversation prematurely?</li>
                                <li><strong>Task Completion/Conversion Rates:</strong> Did the AI successfully assist the user in completing a desired task (e.g., making a purchase, booking an appointment, finding specific information)?</li>
                            </ul>
                            <p class="text-sm text-slate-700 mt-3"><strong class="text-teal-600">Benefit:</strong> Provides potentially large volumes of data that can be collected passively. However, these signals can be noisy and require careful interpretation and analysis to derive meaningful insights.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="slide10-ch10" class="content-section">
                <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-semibold text-sky-700 mb-6">Designing Systems for Feedback Collection</h2>
                    <p class="mb-6 text-slate-600">Effectively collecting user feedback requires thoughtful system design that encourages user participation without disrupting their experience. This section outlines key strategies for building robust feedback collection mechanisms.</p>
                    <p class="mb-4 text-slate-700"><strong class="text-sky-600">Goal:</strong> Collect high-quality, actionable feedback in a way that is easy for users and does not negatively impact their overall experience with the AI application.</p>
                    
                    <div id="feedbackStrategiesAccordion" class="space-y-3">
                        </div>
                     <p class="mt-6 text-sm text-slate-700 font-semibold"><strong class="text-teal-600">Iterative Improvement:</strong> User feedback is not a one-time collection effort; it forms a crucial part of the continuous improvement loop for AI applications, driving both model updates and product enhancements.</p>
                </div>
            </section>

            <section id="slide11-ch10" class="content-section">
                <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-semibold text-sky-700 mb-6">Conclusion: Holistic AI System Design</h2>
                    <p class="mb-6 text-slate-600">Chapter 10 brings together the diverse threads of AI engineering, emphasizing that building successful and robust AI applications requires a holistic approach. This involves not only selecting and implementing individual techniques but also integrating them into a cohesive system architecture and establishing strong feedback loops.</p>
                    
                    <div class="flex flex-col lg:flex-row gap-8 items-center">
                        <div class="lg:w-2/3">
                            <h3 class="text-xl font-semibold text-sky-600 mb-3">Key Pillars of Holistic Design:</h3>
                            <ul class="list-disc list-inside space-y-2 text-slate-700 text-sm">
                                <li><strong class="text-teal-600">Progressive Architecture:</strong> Building AI systems incrementally, starting simple and adding layers for context augmentation (RAG), protection (guardrails), intelligent routing, performance optimization (caching), and advanced agentic capabilities as needed. This allows for managing complexity and adapting to evolving requirements.</li>
                                <li><strong class="text-teal-600">User Feedback Integration:</strong> Actively and systematically collecting, analyzing, and leveraging both direct and implicit user feedback. This feedback is a vital data source for continuous model improvement, alignment, and overall product refinement.</li>
                            </ul>
                            <p class="mt-4 text-slate-700 text-sm"><strong class="text-sky-600">Iterative Development:</strong> The entire lifecycle of designing, building, deploying, and improving AI applications is inherently iterative. Success is driven by continuous learning from data, user insights, and performance monitoring.</p>
                            <p class="mt-2 text-slate-700 text-sm"><strong class="text-sky-600">Future-Proofing:</strong> Understanding these architectural patterns and establishing robust feedback loops is essential for developing AI solutions that are not only effective today but are also scalable, adaptable, robust, and user-centric, allowing them to evolve and improve over time.</p>
                        </div>
                        <div class="lg:w-1/3">
                             <h3 class="text-xl font-semibold text-sky-600 mb-4 text-center">Core Themes of Chapter 10</h3>
                            <div class="chart-container bg-slate-50 p-2 rounded-lg border border-slate-200">
                                <canvas id="conclusionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            
            function showSection(targetId) {
                contentSections.forEach(section => section.classList.remove('active'));
                const activeSection = document.getElementById(targetId);
                if (activeSection) activeSection.classList.add('active');
                
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.dataset.target === targetId) link.classList.add('active');
                });
                document.querySelector('main').scrollTop = 0;

                // Special handling for combined architecture section
                if (targetId.startsWith('slide') && parseInt(targetId.split('-')[0].substring(5)) >= 2 && parseInt(targetId.split('-')[0].substring(5)) <= 7) {
                    showSection('slide2-ch10'); // Show the main architecture section
                    const layerId = 'arch-layer-' + targetId.substring(5); // e.g., arch-layer-3
                    const layerButton = document.querySelector(`.arch-layer[data-layerid="${layerId}"]`);
                    if(layerButton) layerButton.click(); // Simulate click on the specific layer
                }
            }

            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    showSection(this.dataset.target);
                });
            });

            // Progressive Architecture Layers (Slides 2-7)
            const archLayersNav = document.getElementById('archLayersNav');
            const archLayerDetailDiv = document.getElementById('archLayerDetail');
            const archLayers = [
                { id: 'base', name: 'Base Layer: Direct Model Integration', slide: 'slide2-ch10' },
                { id: 'enhancement', name: 'Enhancement: RAG', slide: 'slide3-ch10' },
                { id: 'protection', name: 'Protection: Guardrails', slide: 'slide4-ch10' },
                { id: 'routing', name: 'Routing: Gateway/Router', slide: 'slide5-ch10' },
                { id: 'performance', name: 'Performance: Caching', slide: 'slide6-ch10' },
                { id: 'agent', name: 'Agent Layer', slide: 'slide7-ch10' }
            ];

            if (archLayersNav && archLayerDetailDiv) {
                archLayers.forEach((layer, index) => {
                    const layerDiv = document.createElement('div');
                    layerDiv.className = 'arch-layer';
                    layerDiv.textContent = layer.name;
                    layerDiv.dataset.layerid = `arch-layer-${layer.id}`; // Use consistent ID
                    
                    layerDiv.onclick = () => {
                        archLayersNav.querySelectorAll('.arch-layer').forEach(el => el.classList.remove('active-layer', 'bg-sky-200', 'border-sky-400'));
                        layerDiv.classList.add('active-layer', 'bg-sky-200', 'border-sky-400');
                        
                        const contentEl = document.getElementById(`arch-layer-${layer.id}-content`);
                        if (contentEl) {
                            archLayerDetailDiv.innerHTML = contentEl.innerHTML;
                        } else {
                            archLayerDetailDiv.innerHTML = `<p class="text-slate-500 text-center pt-10">Details for ${layer.name} not found.</p>`;
                        }
                    };
                    archLayersNav.appendChild(layerDiv);
                    if (index < archLayers.length - 1) {
                        const arrowDiv = document.createElement('div');
                        arrowDiv.className = 'arch-layer-arrow self-center';
                        arrowDiv.innerHTML = '▼';
                        archLayersNav.appendChild(arrowDiv);
                    }
                });
            }


            // Generic Accordion Initializer
            function initializeAccordion(containerId, itemsData, itemClasses, headerClasses, contentClasses, arrowClasses) {
                const accordionContainer = document.getElementById(containerId);
                if (!accordionContainer) return;
                accordionContainer.innerHTML = ''; 

                itemsData.forEach(itemData => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = itemClasses || 'accordion-item border border-slate-200 rounded-lg';
                    
                    const headerDiv = document.createElement('div');
                    headerDiv.className = headerClasses || 'accordion-header bg-slate-50 p-3 flex justify-between items-center rounded-t-lg hover:bg-slate-100 transition';
                    headerDiv.innerHTML = `<span class="font-medium text-slate-700 text-sm">${itemData.title}</span><span class="arrow ${arrowClasses || 'text-slate-700'} transform transition-transform duration-300 text-sm">▼</span>`;
                    
                    const contentDiv = document.createElement('div');
                    contentDiv.className = contentClasses || 'accordion-content p-3 bg-white rounded-b-lg';
                    
                    let contentHTML = `<p class="text-slate-600 text-xs">${itemData.content}</p>`;
                     if (itemData.subpoints) {
                        contentHTML += '<ul class="list-disc list-inside ml-4 mt-2 space-y-1 text-xs text-slate-500">';
                        itemData.subpoints.forEach(sub => contentHTML += `<li>${sub}</li>`);
                        contentHTML += '</ul>';
                    }
                    contentDiv.innerHTML = contentHTML;
                    
                    itemDiv.appendChild(headerDiv);
                    itemDiv.appendChild(contentDiv);
                    accordionContainer.appendChild(itemDiv);

                    headerDiv.addEventListener('click', () => {
                        const isOpen = contentDiv.classList.contains('open');
                        if (isOpen) {
                            contentDiv.classList.remove('open');
                            contentDiv.style.maxHeight = null;
                            headerDiv.querySelector('.arrow').classList.remove('rotate-180');
                        } else {
                            contentDiv.classList.add('open');
                            contentDiv.style.maxHeight = contentDiv.scrollHeight + "px";
                            headerDiv.querySelector('.arrow').classList.add('rotate-180');
                        }
                    });
                });
            }
            
            const feedbackStrategiesData = [
                { title: 'Strategic Placement', content: 'Integrate feedback mechanisms naturally within the conversational flow, at points where users are most likely to have an opinion (e.g., after a complex answer, or if they rephrase a query).' },
                { title: 'Minimal Friction', content: 'Make it extremely easy and quick for users to provide feedback. One-click ratings (thumbs up/down, star ratings) are often more effective than requiring lengthy text input.' },
                { title: 'Contextual Prompts', content: 'Ask for feedback at relevant points in the conversation, such as after the AI provides a particularly complex piece of information or completes a multi-turn task.' },
                { title: 'A/B Testing', content: 'Experiment with different feedback mechanisms, prompts, and placements to determine what yields the most useful and highest volume of feedback for your specific application.' },
                { title: 'Automated Signal Extraction', content: 'Develop systems to automatically analyze user interactions and extract implicit feedback signals (e.g., identifying rephrased questions, abandoned sessions, or successful task completions based on user actions).' },
                { title: 'Human-in-the-Loop for Critical Feedback', content: 'For critical feedback, ambiguous signals, or complex issues reported by users, route these instances to human reviewers for detailed analysis, labeling, and potential escalation.' }
            ];
            initializeAccordion('feedbackStrategiesAccordion', feedbackStrategiesData,
                'accordion-item border border-teal-200 rounded-lg',
                'accordion-header bg-teal-50 p-3 flex justify-between items-center rounded-t-lg hover:bg-teal-100 transition',
                'accordion-content p-3 bg-white rounded-b-lg',
                'text-teal-700'
            );

            // Chart.js for Conclusion (Slide 11)
            const conclusionCtx = document.getElementById('conclusionChart');
            if (conclusionCtx) {
                new Chart(conclusionCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Progressive Architecture', 'User Feedback Integration'],
                        datasets: [{
                            label: 'Key Pillars of Holistic AI System Design',
                            data: [60, 40], // Conceptual values
                            backgroundColor: [
                                'rgba(56, 189, 248, 0.7)',  // sky-400
                                'rgba(20, 184, 166, 0.7)'  // teal-500
                            ],
                            borderColor: [
                                'rgba(56, 189, 248, 1)',
                                'rgba(20, 184, 166, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { font: { size: 10 }, boxWidth: 12, padding:10 }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.raw}% (Conceptual Emphasis)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // Initial section display
            if (navLinks.length > 0) {
                 // Trigger click on the first architecture layer if the architecture section is active by default
                const firstArchLayerButton = document.querySelector(`.arch-layer[data-layerid="arch-layer-base"]`);
                if (firstArchLayerButton && document.getElementById('slide2-ch10').classList.contains('active')) {
                    firstArchLayerButton.click();
                } else {
                     showSection(navLinks[0].dataset.target); // Default to first slide if not architecture
                }
            }
             // Default to showing the first architecture layer detail if slide2-ch10 is active
            if (document.getElementById('slide2-ch10').classList.contains('active')) {
                const firstArchLayerButton = archLayersNav.querySelector('.arch-layer');
                if (firstArchLayerButton) {
                    firstArchLayerButton.click();
                }
            }


        });
    </script>
</body>
</html>
